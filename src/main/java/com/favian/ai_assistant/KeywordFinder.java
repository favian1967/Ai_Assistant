package com.favian.ai_assistant;

import java.util.Map;
import java.util.List;

public class KeywordFinder {


    private static final Map<String, List<String>> ROUTES = Map.ofEntries(

            Map.entry("GET_ACCOUNT_INFO", List.of(
                    "как открыть счет", "создать счет", "новый счет",
                    "открытие счета", "завести счет", "открыть счёт",
                    "хочу счет", "нужен счет", "оформить счет",
                    "процедура открытия", "документы для счета",
                    "условия открытия", "открыть расчетный"
            )),

            Map.entry("GET_ACCOUNT_TYPES", List.of(
                    "какие счета", "типы счетов", "виды счетов",
                    "разница между счетами", "типы вкладов",
                    "расчетный счет", "сберегательный счет",
                    "накопительный счет", "депозитный счет",
                    "какой счет выбрать", "чем отличаются счета"
            )),

            Map.entry("GET_ACCOUNT_BALANCE", List.of(
                    "баланс счета", "остаток на счете", "сколько денег",
                    "проверить баланс", "узнать баланс",
                    "сколько на счету", "мой баланс", "проверить остаток",
                    "где посмотреть баланс", "какой баланс",
                    "сколько средств", "остаток средств"
            )),

            Map.entry("GET_ACCOUNT_LIMITS", List.of(
                    "сколько счетов", "несколько счетов",
                    "количество счетов", "ограничение счетов",
                    "можно открыть несколько", "лимит счетов",
                    "максимум счетов"
            )),

            Map.entry("GET_ACCOUNT_STATUS", List.of(
                    "статус счета", "заблокирован счет",
                    "активный счет", "закрытый счет",
                    "счет работает", "почему заблокирован",
                    "счет заморожен", "недоступен счет"
            )),

            Map.entry("GET_CURRENCIES", List.of(
                    "какие валюты", "валюты счетов",
                    "счет в долларах", "счет в евро", "доступные валюты",
                    "мультивалютный", "валютный счет",
                    "в какой валюте", "рубли доллары евро",
                    "иностранная валюта"
            )),

            Map.entry("GET_CARD_ISSUE_INFO", List.of(
                    "как выпустить карту", "заказать карту",
                    "оформить карту", "получить карту", "создать карту",
                    "хочу карту", "нужна карта", "выдать карту",
                    "сделать карту", "новая карта",
                    "условия выпуска", "документы для карты"
            )),

            Map.entry("GET_CARD_TYPES", List.of(
                    "типы карт", "виды карт",
                    "дебетовая", "кредитная", "разница между картами",
                    "какую карту выбрать", "виртуальная карта",
                    "премиум карта", "классик", "голд",
                    "чем отличаются карты", "платиновая"
            )),

            Map.entry("BLOCK_CARD_INFO", List.of(
                    "заблокировать карту", "потерял карту",
                    "украли карту", "заморозить карту",
                    "срочно заблокировать", "остановить карту",
                    "приостановить карту", "утеряна карта",
                    "пропала карта", "блокировка карты",
                    "как заблокировать"
            )),

            Map.entry("UNBLOCK_CARD_INFO", List.of(
                    "разблокировать карту", "снять блокировку",
                    "активировать карту", "разморозить",
                    "включить карту", "возобновить карту",
                    "карта не работает", "нашел карту"
            )),

            Map.entry("GET_CARD_BALANCE", List.of(
                    "баланс карты", "сколько на карте", "остаток на карте",
                    "проверить карту", "деньги на карте",
                    "средства на карте", "какой баланс карты"
            )),

            Map.entry("GET_CARD_LIMITS", List.of(
                    "сколько карт", "несколько карт", "количество карт",
                    "можно выпустить несколько", "лимит карт",
                    "максимум карт"
            )),

            Map.entry("GET_CARD_STATUS", List.of(
                    "статус карты", "активная карта", "просроченная карта",
                    "карта действует", "срок карты",
                    "истекла карта", "до какого числа"
            )),

            Map.entry("DEPOSIT_INFO", List.of(
                    "пополнить счет", "внести деньги",
                    "положить на счет", "пополнение", "зачислить",
                    "как пополнить", "способы пополнения",
                    "закинуть деньги", "перечислить на счет",
                    "добавить средства", "ввести деньги"
            )),

            Map.entry("WITHDRAW_INFO", List.of(
                    "снять деньги", "вывести средства",
                    "снятие", "обналичить",
                    "как снять", "где снять", "получить деньги",
                    "вывод денег", "забрать деньги"
            )),

            Map.entry("TRANSFER_INFO", List.of(
                    "перевести деньги", "перевод",
                    "отправить деньги", "платеж", "транзакция",
                    "как перевести", "способы перевода",
                    "сделать перевод", "послать деньги",
                    "передать деньги", "переслать",
                    "по номеру телефона", "на карту"
            )),

            Map.entry("GET_TRANSACTION_HISTORY", List.of(
                    "история операций", "история транзакций",
                    "выписка", "мои переводы",
                    "посмотреть операции", "список операций",
                    "все операции", "движение средств",
                    "куда ушли деньги", "откуда пришли",
                    "детализация", "история платежей"
            )),

            Map.entry("IDEMPOTENCY_INFO", List.of(
                    "idempotency", "идемпотентность",
                    "дублирование операции",
                    "повторный платеж", "списалось дважды",
                    "двойное списание"
            )),

            Map.entry("GET_LIMITS_INFO", List.of(
                    "лимиты", "ограничения переводов",
                    "максимальная сумма", "сколько можно перевести",
                    "минимальная сумма", "дневной лимит",
                    "месячный лимит", "ограничения по сумме",
                    "лимит в день", "больше нельзя"
            )),

            Map.entry("REGISTRATION_INFO", List.of(
                    "зарегистрироваться", "регистрация",
                    "создать аккаунт", "открыть кабинет",
                    "личный кабинет", "как зарегистрироваться",
                    "стать клиентом", "новый пользователь",
                    "первый раз", "начать работу"
            )),

            Map.entry("LOGIN_INFO", List.of(
                    "войти", "вход", "авторизация", "логин",
                    "как войти", "не могу войти",
                    "зайти в кабинет", "открыть кабинет",
                    "доступ", "залогиниться"
            )),

            Map.entry("LOGOUT_INFO", List.of(
                    "выйти", "выход", "разлогиниться",
                    "как выйти", "закрыть сессию",
                    "завершить сеанс"
            )),

            Map.entry("CHANGE_PASSWORD_INFO", List.of(
                    "изменить пароль", "сменить пароль", "поменять пароль",
                    "новый пароль", "обновить пароль",
                    "как изменить пароль", "восстановить пароль"
            )),

            Map.entry("EMAIL_CONFIRMATION_INFO", List.of(
                    "подтвердить email", "верификация почты",
                    "код подтверждения",
                    "подтверждение почты", "активация email",
                    "не пришел код", "где код", "смс код",
                    "подтвердить адрес"
            )),

            Map.entry("SECURITY_INFO", List.of(
                    "безопасность", "защита данных", "надежность",
                    "безопасно ли", "как защищены данные",
                    "шифрование", "конфиденциальность",
                    "двухфакторная", "2fa", "защита аккаунта"
            )),

            Map.entry("FEES_INFO", List.of(
                    "комиссия", "плата", "тариф",
                    "сколько стоит", "бесплатно",
                    "стоимость", "расценки", "цены",
                    "сборы", "какая комиссия", "процент"
            )),

            Map.entry("SYSTEM_INFO", List.of(
                    "что можно делать", "возможности системы", "функции",
                    "что умеешь", "какие услуги",
                    "какие операции", "сервисы",
                    "что доступно", "чем можешь помочь"
            )),

            Map.entry("WORKING_HOURS", List.of(
                    "график работы", "режим работы",
                    "часы работы", "когда работает",
                    "в какое время", "круглосуточно",
                    "выходные", "по выходным"
            )),

            Map.entry("CONTACT_INFO", List.of(
                    "контакты", "телефон", "адрес",
                    "как связаться", "горячая линия",
                    "номер телефона", "почта", "email банка"
            )),

            Map.entry("MOBILE_APP_INFO", List.of(
                    "мобильное приложение", "приложение",
                    "скачать приложение", "установить приложение",
                    "app", "апп", "мобильный банк"
            )),

            Map.entry("ESCALATE_TO_OPERATOR", List.of(
                    "оператор", "живой человек", "поддержка",
                    "жалоба", "претензия", "мошенничество",
                    "украли", "взлом", "забыл пароль",
                    "кредит", "ипотека", "офис",
                    "наличные", "банкомат",
                    "менеджер", "специалист", "консультант",
                    "не понимаю", "не помогаешь",
                    "бесполезный", "хочу человека"
            ))
    );
    public static String route(String question) {

        if (question == null) return "ESCALATE_TO_OPERATOR";

        String q = normalize(question);

        for (var entry : ROUTES.entrySet()) {
            for (String keyword : entry.getValue()) {
                if (q.contains(keyword)) {
                    return entry.getKey();
                }
            }
        }

        return "CALL_AI";
    }
    private static String normalize(String s) {
        return s.toLowerCase()
                .replace('ё', 'е')
                .replaceAll("[^a-zа-я0-9 ]", "")
                .trim();
    }

}
